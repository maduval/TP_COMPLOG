<?php

namespace imie\ComplogBundle\Repository;

/**
 * InvoiceRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */

use Doctrine\ORM\EntityRepository;

class InvoiceRepository extends EntityRepository
{
    /**
     * @return string
     */
    public function getNextRef(){

        $invoice = $this->findOneBy(
            array(),
            array('id' => 'DESC')
        );
        $lastRef = $invoice->getRef();
        $lastNumber = preg_replace("/[^0-9]/", '', $lastRef);

        $nextNumber = (int)$lastNumber + 1;
        $nextRef = 'INVO' . (string)$nextNumber;

        return $nextRef;
    }
}
